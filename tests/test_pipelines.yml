- name: SingleEnd
  tags:
    - integration
    - no_docker_conf
  command: cromwell run -i tests/integration/SingleEnd.json -o tests/cromwell_options.json small-rna.wdl
  files:
    - path: "test-output/SRR8704569/ensembl.gtf.tsv"
    - path: "test-output/SRR8704569/hsa.gff3.tsv"
    - path: "test-output/SRR8704569/lib1-rg1/SRR8704569_fastqc.html"
    - path: "test-output/SRR8704570/ensembl.gtf.tsv"
    - path: "test-output/SRR8704570/hsa.gff3.tsv"
    - path: "test-output/SRR8704570/lib1-rg1/SRR8704570_fastqc.html"

- name: PairedEnd
  tags:
    - integration
    - no_docker_conf
  command: cromwell run -i tests/integration/PairedEnd.json -o tests/cromwell_options.json small-rna.wdl
  files:
    - path: "test-output/SRR5087327/ensembl.gtf.tsv"
    - path: "test-output/SRR5087327/hsa.gff3.tsv"
    - path: "test-output/SRR5087327/lib1-rg1/SRR5087327_R1_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg1/SRR5087327_R2_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg2/SRR5087327_R1_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg2/SRR5087327_R2_fastqc.html"

- name: PairedEndAbsoluteFolder
  tags:
    - integration
    - docker_conf
  command: >-
    bash -c '
    TEST_JSON=tests/integration/PairedEnd.json ;
    sed -i "2i\"SmallRna.outputDir\":\"$PWD/test-output\"," $TEST_JSON ;
    cromwell run -i $TEST_JSON small-rna.wdl'
  files:
    - path: "test-output/SRR5087327/ensembl.gtf.tsv"
    - path: "test-output/SRR5087327/hsa.gff3.tsv"
    - path: "test-output/SRR5087327/lib1-rg1/SRR5087327_R1_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg1/SRR5087327_R2_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg2/SRR5087327_R1_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg2/SRR5087327_R2_fastqc.html"
    - path: "test-output/SRR5087327/lib1-rg1/lib1-rg1.bam"
    - path: "test-output/SRR5087327/lib1-rg1/lib1-rg2.bam"
    - path: "test-output/multiqc_report.html"
